<html>

<head>
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  </script>

  <main id="app"></main>

  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

  <script type="module">
    import {
      GenomeBrowser,
      default as init,
    } from "./pkg/peregrine_generic.js";

    const elem = React.createElement;

    const App = () => {
      React.useEffect(() => {
        activateGenomeBrowser();
      });

      const activateGenomeBrowser = async () => {
        await init();

        let genome_browser = new GenomeBrowser();

        genome_browser.go({
          "spectre.stain.colour": "rgba(255,0,0,0.5)"
        });

        genome_browser.set_message_reporter(function (x) {
          console.error("this is my message receiver: " + x);
        });
        genome_browser.set_stick("homo_sapiens_GCA_000001405_27:1");
        genome_browser.set_switch(["track", "gene-pc-fwd"]);
        genome_browser.set_switch(["track", "gene-other-fwd"]);
        genome_browser.set_switch(["track", "gene-other-rev"]);
        genome_browser.set_switch(["track", "gene-other-fwd", "label"]);
        genome_browser.set_switch(["track", "gene-other-rev", "label"]);
        genome_browser.set_switch(["track", "gc"]);
        genome_browser.set_switch(["track", "contig"]);
        genome_browser.goto(1000000, 2500000);
        genome_browser.set_switch(["settings"]);
      };

      return elem("div", null, [
        elem("div", { className: "grid", id: "grid", key: 2 }, [
          elem("div", { className: "viewport", id: "browser", key: 101 }),
          elem("div", { className: "other", id: "other", key: 102 }),
        ]),
      ]);
    };

    ReactDOM.render(elem(App), document.getElementById("app"));
  </script>
</body>

</html>
